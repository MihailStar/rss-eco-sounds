(()=>{"use strict";const t=[{title:"Соловей",link:"./assets/solovey.mp3",cover:"./images/solovey.jpg"},{title:"Дрозд",link:"./assets/drozd.mp3",cover:"./images/drozd.jpg"},{title:"Малиновка",link:"./assets/zarynka.mp3",cover:"./images/zarynka.jpg"},{title:"Жаворонок",link:"./assets/javoronok.mp3",cover:"./images/javoronok.jpg"},{title:"Славка",link:"./assets/slavka.mp3",cover:"./images/slavka.jpg"}];const n={prev:'\n    <path d="M0 0h24v24H0V0z" fill="none" />\n    <path d="M6 6h2v12H6zm3.5 6l8.5 6V6l-8.5 6zm6.5 2.14L12.97 12 16 9.86v4.28z" />\n  ',stop:'\n    <path d="M0 0h24v24H0V0z" fill="none" />\n    <path d="M16 8v8H8V8h8m2-2H6v12h12V6z" />\n  ',play:'\n    <path d="M0 0h24v24H0V0z" fill="none" />\n    <path d="M10 8.64L15.27 12 10 15.36V8.64M8 5v14l11-7L8 5z" />\n  ',pause:'\n    <path d="M0 0h24v24H0V0z" fill="none" />\n    <path d="M6 19h4V5H6v14zm8-14v14h4V5h-4z" />\n  ',next:'\n    <path d="M0 0h24v24H0V0z" fill="none" />\n    <path d="M6 18l8.5-6L6 6v12zm2-8.14L11.03 12 8 14.14V9.86zM16 6h2v12h-2z" />\n  '};!function(t){for(let n=0;n<t.length;n+=1)(new Audio).src=t[n].link,(new Image).src=t[n].cover}(t);let e=!1,s=!1;const r=new class{constructor(t){let{playlist:n,currentIndex:e=null}=t;this.onInit=()=>{},this.onChanged=()=>{},this.onPlayed=()=>{},this.playlist=n,this.current=e,this.$audio=new Audio,this.$audio.loop=!0,"number"==typeof this.current&&(this.$audio.src=this.playlist[this.current].link),this.$audio.addEventListener("play",(()=>this.onPlayed({isPlayed:!0}))),this.$audio.addEventListener("pause",(()=>this.onPlayed({isPlayed:!1}))),setTimeout((()=>this.onInit({currentIndex:this.current})),0)}get currentIndex(){return this.current}set currentIndex(t){if(this.current=t,this.isPlayed){if(null===this.current)return void this.stop();this.play()}this.onChanged({currentIndex:this.current})}get isPlayed(){return!this.$audio.paused}prev(){const t=this.playlist.length-1;if(null===this.currentIndex)return void(this.currentIndex=t);const n=this.currentIndex-1;this.currentIndex=n<0?t:n}stop(){this.$audio.pause(),this.$audio.currentTime=0,this.currentIndex=null}play(){null===this.currentIndex&&(this.currentIndex=0);const t=new URL(this.playlist[this.currentIndex].link,window.location.href).toString();if(this.$audio.src===t)return this.isPlayed&&(this.$audio.currentTime=0),void this.$audio.play().catch((t=>console.error(t)));this.$audio.src=this.playlist[this.currentIndex].link,this.$audio.play().catch((t=>console.error(t)))}pause(){this.$audio.pause()}next(){const t=this.playlist.length-1;if(null===this.currentIndex)return void(this.currentIndex=0);const n=this.currentIndex+1;this.currentIndex=n>t?0:n}}({playlist:t}),i=document.querySelector(".header__buttons");if(!(i instanceof HTMLElement))throw new Error("Сontainer not found");const o=new class{constructor(t){let{container:n,buttons:e,currentIndex:s=null}=t;var r,i,o;r=this,i="$buttonToIndex",o=new Map,i in r?Object.defineProperty(r,i,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[i]=o,this.onInit=()=>{},this.onChanged=()=>{},this.current=s,this.$buttons=e.map(((t,n)=>{let{title:e}=t;const s=document.createElement("button");return s.classList.add("header-buttons__button"),n===this.current&&s.classList.add("header-buttons__button_current"),s.type="button",s.textContent=e,this.$buttonToIndex.set(s,n),s}));const a=document.createElement("div");a.classList.add("header-buttons"),a.append(...this.$buttons),a.addEventListener("click",(t=>this.handleButtonsWrapperClick(t))),n.append(a),setTimeout((()=>this.onInit({currentIndex:this.current})),0)}get currentIndex(){return this.current}set currentIndex(t){this.current=t,this.$buttons.forEach(((t,n)=>{n!==this.current?t.classList.remove("header-buttons__button_current"):t.classList.add("header-buttons__button_current")})),this.onChanged({currentIndex:this.current})}handleButtonsWrapperClick(t){if(!(t.target instanceof HTMLButtonElement))return;t.preventDefault();const n=this.$buttonToIndex.get(t.target);this.currentIndex=this.currentIndex===n?null:null!=n?n:null}}({container:i,buttons:t});o.onChanged=t=>{let{currentIndex:n}=t;e?e=!1:(r.currentIndex=n,r.isPlayed||"number"!=typeof n||r.play())},r.onChanged=n=>{let{currentIndex:s}=n;e=!0,o.currentIndex=s,document.body.style.backgroundImage=null===s?"":"url('".concat(t[s].cover,"')")};const a=document.querySelector(".main__button");if(!(a instanceof HTMLElement))throw new Error("Сontainer not found");const u=new class{constructor(t){let{container:n,isPressed:e=!1}=t;this.onInit=()=>{},this.onPressed=()=>{},this.pressed=e,this.$button=document.createElement("button"),this.$button.classList.add("main-button"),this.pressed&&this.$button.classList.add("main-button_pressed"),this.$button.type="button",this.$button.ariaPressed=this.pressed?"true":"false",this.$button.innerHTML='\n      <svg\n        class="main-button__image main-button__image_play"\n        xmlns="http://www.w3.org/2000/svg"\n        width="56"\n        height="56"\n        viewBox="0 0 24 24"\n        fill="currentColor"\n      >\n        <path d="M0 0h24v24H0V0z" fill="none" />\n        <path d="M10 8.64L15.27 12 10 15.36V8.64M8 5v14l11-7L8 5z" />\n      </svg>\n      <svg\n        class="main-button__image main-button__image_pause"\n        xmlns="http://www.w3.org/2000/svg"\n        width="56"\n        height="56"\n        viewBox="0 0 24 24"\n        fill="currentColor"\n      >\n        <path d="M0 0h24v24H0V0z" fill="none" />\n        <path d="M6 19h4V5H6v14zm8-14v14h4V5h-4z" />\n      </svg>\n    ',this.$button.addEventListener("click",(t=>this.handleButtonClick(t))),n.append(this.$button),setTimeout((()=>this.onInit({isPressed:this.pressed})),0)}get isPressed(){return this.pressed}set isPressed(t){this.pressed=t,this.$button.classList[this.pressed?"add":"remove"]("main-button_pressed"),this.$button.ariaPressed=this.pressed?"true":"false",this.onPressed({isPressed:this.pressed})}handleButtonClick(t){t.preventDefault(),this.isPressed=!this.isPressed}}({container:a,isPressed:!1});u.onPressed=t=>{let{isPressed:n}=t;s?s=!1:n?r.play():r.pause()},r.onPlayed=t=>{let{isPlayed:n}=t;s=!0,u.isPressed=n};const l=document.querySelector(".footer__buttons");if(!(l instanceof HTMLElement))throw new Error("Сontainer not found");new class{constructor(t){let{container:e,buttons:s}=t;var r,i,o;r=this,i="$buttonToCommand",o=new Map,i in r?Object.defineProperty(r,i,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[i]=o,this.onInit=()=>{},this.onChanged=()=>{},this.current=null,this.$buttons=s.map((t=>{let{title:e,command:s}=t;const r=document.createElement("button");return r.classList.add("footer-buttons__button","footer-buttons__button_".concat(s)),r.type="button",r.ariaLabel=e,r.innerHTML='\n        <svg\n          class="footer-buttons__image footer-buttons__image_'.concat(s,'"\n          xmlns="http://www.w3.org/2000/svg"\n          width="').concat("play"===s?28:20,'"\n          height="').concat("play"===s?28:20,'"\n          viewBox="0 0 24 24"\n          fill="currentColor"\n        >\n          ').concat(n[s],"\n        </svg>\n      "),this.$buttonToCommand.set(r,s),r}));const a=document.createElement("div");a.classList.add("footer-buttons"),a.append(...this.$buttons),a.addEventListener("click",(t=>this.handleButtonsWrapperClick(t))),e.append(a),setTimeout((()=>this.onInit({currentCommand:this.current})),0)}get currentCommand(){return this.current}set currentCommand(t){this.current=t,this.onChanged({currentCommand:this.current})}handleButtonsWrapperClick(t){var n;t.target instanceof HTMLButtonElement&&(t.preventDefault(),this.currentCommand=null!==(n=this.$buttonToCommand.get(t.target))&&void 0!==n?n:null)}}({container:l,buttons:[{title:"Стоп",command:"stop"},{title:"Воспроизвести",command:"play"},{title:"Пауза",command:"pause"}]}).onChanged=t=>{let{currentCommand:n}=t;null!==n&&r[n]()}})();